---
layout:     post
title:      "Persistence of vision"
subtitle:   "[ARDUINO] [PCB] [3DPRINT]"
date:       2015-04-24 12:00:00
author:     "SturdyEgg"
header-img: "img/post_persistenceofvision/title.jpg"
---
 
 <!-- **[Github Link](https://github.com/deplax/)** -->

#Summary

|**Project name :** Light
|**Language :** Arduino C++
|**Type of project :** Personal project
|**Project duration :** 1 month
|**Source code :** <a href="https://github.com/deplax/T_arduino_led" style="color:#3366FF; font-weight:bold">Github Link</a>

####Brief Description <br>
우리 눈의 잔상효과를 이용한 전광판을 제작했다. <br>
<span style="color:#FF6633">동영상을 꼭 시청해 주시면 좋겠다.</span>

<br/>


#Description
삽질에 삽질을 굉장히 해대서 애착이 많은 프로젝트다. 초기 계획은 스스로 연주하는 악기를 만드는 것으로 클래식기타 줄과 서보모터를 이용하여 제작을 시도하였다. 하지만 악기의 울림판을 제작하고 줄이 고정되는 부분을 제작하려는데 설계과정에서부터 불필요하게 스케일이 증가하여 진행 중간에 중단하고 현재의 프로젝트로 변경하였다.

프로젝트의 내용은 간단하다. LED Bar가 회전하면서 점멸하는 것으로 글자를 만들어낸다. 모터와 회전체모듈은 완전히 독립적으로 움직이며 각각의 전원을 사용한다. 회전체가 회전할 때 가장 바깥에 위치한 홀센서는 자력의 변화를 감지하는데 자력이 감지될 경우 다시 한바퀴 돌아 자력이 감지될 때까지를 반복하여 측정한다. 이 과정이 반복되면 회전체의 속력을 알 수 있고 한바퀴 도는 시간을 나누어 LED를 순차적으로 점멸시킨다. 따라서 속력에 따라 LED점멸 시간이 달라지며 메세지가 출력된다. 영상에서 손으로 가져다 대는 것은 네오디뮴 자석으로 회전체가 자신의 위치를 인지하기 위하여 사용된다.

프로젝트의 전체의 절반은 프레임 제작에 소모되었다. 프레임을 어떻게 제작할까부터 무엇으로 제작할지 확장성 등을 고려하다 보니 쉽게 시작할 수 없었다. 확장가능성을 염두에 두고 Block방식으로 n개를 Rail형으로 길게 확장할 수 있도록 디자인 한 부분은 프로젝트 전체의 생산성과 품질을 굉장히 향상시켰으며 블럭을 설계한 것에 대해 많은 뿌듯함을 느끼고 있다.


<br/><br/>


#Postmortem

####어려웠던 점
* 프레임을 직접 제작.
: 초기에 회전하는 부분을 과학상자 부품과, 나무 막대기를 사용하여 제작했다. 하지만 모터는 작고, 회전체가 무거운 상태에서 균형이 맞지 않으면 전체가 휘청거려 원하는 결과를 기대하기 어려웠다. 드릴로 뚫고 칼로 깎고 어떻게든 맞춰보려 했으나 가공이 쉽지 않았고 다른 이슈가 많은데 회전문제에만 매달려 있었다. 적당한 대체재를 물색하던 중 직접 디자인을 하고 3D 프린터로 출력하는 방법을 선택하였다. 이 선택으로 문제가 쉽게 해결되기를 바랬지만 3D 프린터에서의 오차가 심하였고 블럭 1개를 출력하는데 보통 1시간이 넘게 걸렸는데 중간에 노즐이 끊겨 블럭이 정상적으로 출력되지 않는 경우가 다반사였다.

* 쓰레드가 없다.
: 회전과 LED점멸의 싱크를 맞추던 도중 뒤늦게 중요한 사실을 깨달았다. 이두아노를 쓰레드 프로그래밍이 불가능하다. 비슷한 흉내를 내는 라이브러리를 찾았으나 해결책이 되지 못하였고, 이 문제를 근본적으로 해결하려면 Interruptor를 사용해야 했다. 하지만 이미 납땜과 프레임이 고정된 후였고 고민중에 라이브러리와 시간, 마커를 조합하여 결과를 만들어냈다.

* 통신모듈을 달지 못하였다.
: 초기 계획은 32개의 LED가 박히는 조금은 대형의 전광판이었으나 납땜시간이 생각보다 오래거려 절반은 16개로 만들고 후에 확장할 수 있도록 설계하였다. 통신모듈도 확장되는 위치에 설치될 계획이었는데 nRF24L01 모듈을 테스트 해두고 후에 확장하여 실시간으로 전광판의 내용을 수정하고자 하였다. 하지만 후반에 갈수록 지쳐 확장은 무효화 되고 16개의 LED만 남게 되었다. 

####잘된 점.
* 블럭형 프레임.
: 프로젝트 초반 독립모듈이 안정적으로 회전할 수 있는 프레임이 필요했는데 원하는 재료를 찾지 못하였다. 과학상자도 사용해 보고, 나무도 깎아 봤으나 균형을 정확히 맞추는 데에는 무리였고 전용 프레임이 있으면 좋겠다고 생각했다. 프레임을 직접 디자인하기로 결정했고 후에 확장할 수 있도록 나사를 박을 수 있는 홀과, 블럭 조립형이 가능한 레일로 만들어 길이를 원하는 길이만큼 늘릴 수 있도록 하였다. 또 무게중심을 위해 무거운 배터리의 위치를 미세하게 조정 가능하도록 디자인하여 이 문제를 깔끔하게 해결해냈다.

* 정확한 부품의 계산.
: 하드웨어를 다룰 때는 부품 구매부터 많은 문제가 발생한다. 같은 역할을 하는 부품은 여러개가 있고 이 상황에서 어느 부품이 적합할지 데이터시트를 보며 생각해야 하고 부품의 수량과 단가는 예산과 예산과 밀접한 연관을 갖는다. 또 프로젝트 중간에 실수로 부품을 태우거나 생각과는 다른 퍼포먼스를 보여줘 부품을 교체하려 한다면 부품 배송 기간동안 진행이 어렵게 된다. 하지만 이 프로젝트에서는 처음 계산된 부품들이 끝까지 사용되었고 지난 경험이 프로젝트의 기간을 단축시켰다.

* 각각의 모듈별로 테스트.
: 프로젝트 중간에 시행착오가 너무 빈번하게 발생하여 상당히 지친상태에 있었다. 마무리 가능성이 불투명한 상태에서 프레임조차 나오지 않았으나, 브레드보드와 모듈만 구동하는 코드를 이용하여 홀센서부, 모터부, 74HC595, LED점멸 등 기능 단위로 테스트하여 납땜과정이 끝난 후에도 예외사항은 다소 발생하지 않았다. 오히려 프로젝트 후반에 더욱 속력을 내며 마무리하였다.

<br/><br/>


#Preview video
<iframe src="https://www.youtube.com/embed/FQFfjZNH_is" frameborder="0" allowfullscreen></iframe>

<br>

<iframe src="https://www.youtube.com/embed/UblzyLoDfNc" frameborder="0" allowfullscreen></iframe>

<br/><br/>


#Screenshot

<img src="{{ site.baseurl }}/img/post_persistenceofvision/01.png" width="100%" style="text-align: center">